proxy with squid
------------------
1. Squid is quite an old, mature, and commonly used piece of software. It is generally shipped as a default package with various Linux distributions. The Ubuntu package repository contains the necessary pre-compiled binaries, so the installation is as easy as two commands.
2. First, update the apt cache and then install squid as follows:

$ sudo apt-get update
$ sudo apt-get install squid3

3. Edit the /etc/squid3/squid.conf file:
$ sudo nano /etc/squid3/squid.conf

4. Ensure that the cache_dir directive is not commented out:
cache_dir ufs /var/spool/squid3 100 16 256

5. Optionally, change the http_port directive to your desired TCP port:
http_port 8080

6. Optionally, change the squid hostname:
visible_hostname proxy1

7. Save changes with Ctrl + O and exit with Ctrl + X.

8. Restart the squid server:
$ sudo service squid3 restart

9. Make sure that you have allowed the selected http_port on firewall.

10. Next, configure your browser using the squid server as the http/https proxy.

-------------------------------------------------

n our example, we are changing the port squid listens on. The default port is 3128. This is just a security precaution and it's fine if you want to run squid on the default port. Secondly, we have changed the hostname for squid.

Other important directive to look at is cache_dir. Make sure that this directive is enabled, and also set the cache size. The following example sets cache_dir to

/var/spool/suid3 with the size set to 100MB:

cache_dir ufs /var/spool/squid3 100 16 256

To check the cache utilization, use the following command:

$ sudo du /var/spool/squid3

------------------------------------------------------------

advance futures:

#Access control list:
With squid ACLs, you can set the list of IP addresses allowed to use squid. Add the following line at the bottom of the acl section of /etc/squid3/squid.conf:

acl developers src 192.168.2.0/24

Then, add the following line at the top of the http_access section in the same file:

http_access allow developers
-------------------------------------------
##Set cache refresh rules:

You can change squid's caching behavior depending on the file types.Add the following line to cache all image files to be cached—the minimum time is an hour and the maximum is a day:

refresh_pattern -i \.(gif|png|jpg|jpeg|ico)$ 3600 90% 86400

This line uses a regular expression to find the file names that end with any of the listed
file extensions (gif, png, and etc)
----------------------------------------
##Sarg – tool to analyze squid logs
Squid Analysis Report Generator is an open source tool to monitor the squid server usages. It parses the logs generated by Squid and converts them to easy-to-digest HTML-based reports. You can track various metrics such as bandwidth used per user, top sites, downloads, and so on. Sarg can be quickly installed with the following

command:

$ sudo apt-get install sarg

The configuration file for Sarg is located at /etc/squid/sarg.conf. Once installed, set the output_dir path and run sarg. You can also set cron jobs to execute sarg periodically. The generated reports are stored in output_dir and can be accessed with the help of a web server.

---------------------------------------------------------------------
##Squid guard


Squid guard is another useful plugin for squid server. It is generally used to block a list of websites so that these sites are inaccessible from the internal network. As always, it can also be installed with a single command, as follows:

$ sudo apt-get install squidguard

The configuration file is located at /etc/squid/squidGuard.conf.

















